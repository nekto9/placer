import { Request } from 'express';

/**
 * Интерфейс для данных аутентифицированного пользователя
 *
 * Содержит минимальную информацию о пользователе, полученную из JWT токена.
 * Используется в middleware аутентификации для передачи данных пользователя
 * в контроллеры и сервисы.
 */
export interface AuthenticatedUser {
  /**
   * Уникальный идентификатор пользователя (subject) из JWT токена
   */
  sub: string;

  realm_access?: {
    roles?: string[];
  };
}

/**
 * Расширенный интерфейс Express Request с данными аутентифицированного пользователя
 *
 * Используется в контроллерах для получения информации о текущем пользователе
 * после прохождения middleware аутентификации. Позволяет типизированно
 * обращаться к данным пользователя в обработчиках запросов.
 */
export interface AuthenticatedRequest extends Request {
  /**
   * Данные аутентифицированного пользователя
   */
  user: AuthenticatedUser;
}
